// Module included in the following assemblies:
//
// * argocd_instance/argo-cd-cr-component-properties.adoc

:_mod-docs-content-type: CONCEPT
[id="notifications-configuration-custom-resource-properties_{context}"]
= NotificationsConfiguration custom resource properties

The `NotificationsConfiguration` resource is a Kubernetes custom resource (CR) that manages notifications in a Kubernetes cluster. In {gitops-title}, you can add templates, triggers, services, and subscription resources to an Argo CD `Notifications` config map by using  the `NotificationsConfiguration` CR.

When you create a cluster in {gitops-title} with notifications enabled, a `NotificationsConfiguration` CR is created by default with the name `default-notifications-configuration`.

Any change made in the existing configuration of the `NotificationsConfiguration` CR is replicated in the Argo CD `Notifications` config map. For example, if the user adds  trigger configuration in the `NotificationsConfiguration` resource, this configuration is read, processed, and updated in the Argo CD `Notifications` config map.

[IMPORTANT]
====
Any configuration changes must be updated in  the `default-notifications-configuration` CR. Custom resources created by the users for `NotificationsConfiguration` resource are not supported.

Any modification to the Argo CD `argocd-notifications-cm` config map is overridden by the changes made in the `NotificationsConfiguration` CR.
====

.`NotificationsConfiguration` custom resource properties
[cols="1,1,1",options="header"]
|====
|**Properties** |**Default** |**Description**

|Templates
|`__<empty>__`
|Templates are used to generate the notification template message.

|Triggers
|`__<empty>__`
|Triggers are used to define the condition when a notification is sent to the user and the list of templates required to generate the message.

|Services
|`__<empty>__`
|Services are used to deliver a message.

|Subscriptions
|`__<empty>__`
|Subscriptions contain centrally-managed global application subscriptions.
|====

The following examples define how to add templates, triggers, services, and subscription resources to the Argo CD `argocd-notification-cm` config map by using the `default-notifications-configuration` custom resource.

.Example for `templates`
[source,yaml]
----
apiVersion: argoproj.io/v1alpha1
kind: NotificationsConfiguration
metadata:
 name: default-notifications-configuration # <1>
spec:
 templates:
  template.my-custom-template: | # <2>
    message: |
     Application details: {{.context.argocdUrl}}/applications/{{.app.metadata.name}}.
----
<1> Default name of the `NotificationsConfiguration` CR in a cluster.
<2> An example custom template configuration for the `NotificationsConfiguration` CR.

.Example for `triggers`
[source,yaml]
----
apiVersion: argoproj.io/v1alpha1
kind: NotificationsConfiguration
metadata:
 name: default-notifications-configuration # <1>
spec:
 triggers:
  trigger.on-sync-status-unknown: | # <2>
   - when: app.status.sync.status == 'Unknown'
   send: [my-custom-template]
----
<1> Default name of the `NotificationsConfiguration` CR in a cluster.
<2> An example custom trigger configuration for the `NotificationsConfiguration` CR.

.Example for `services`
[source,yaml]
----
apiVersion: argoproj.io/v1alpha1
kind: NotificationsConfiguration
metadata:
 name: default-notifications-configuration # <1>
spec:
 services:
  service.slack: |
    token: $slack-token # <2>
    username: <override-username> # optional username
    icon: <override-icon> # optional icon for the message (supports both emoji and url notation)
----
<1> Default name of the `NotificationsConfiguration` CR in a cluster.
<2> An example custom service configuration for the `NotificationsConfiguration` CR.

The following two examples are used for referencing the `oauth-access-token` in the `argocd-notifications-secret`. These steps are optional. 

.Example for storing `oauth-access-token` in the `argocd-notifications-secret`:
[source,yaml]
----
  apiVersion: v1
  kind: Secret
  metadata:
      name: <secret-name>
  stringData:
      slack-token: <oauth-access-token>
----

.Example for creating a configmap to reference the `oauth-access-token` in the `argo-notifications-secret`:
[source,yaml]
----
  apiVersion: v1
  kind: ConfigMap
  metadata:
    name: argocd-notifications-cm
  data:
    service.slack: |
      token: $slack-token
----

.Example for `subscriptions`
[source,yaml]
----
apiVersion: argoproj.io/v1alpha1
kind: NotificationsConfiguration
metadata:
 name: default-notifications-configuration # <1>
spec:
 Subscriptions: |
  subscriptions: | # <2>
    # subscription for on-sync-status-unknown trigger notifications
    - recipients:
    - slack:test2
    - email:test@gmail.com
    triggers:
    - on-sync-status-unknown
    # subscription restricted to applications with matching labels only
    - recipients:
    - slack:test3
    selector: test=true
    triggers:
    - on-sync-status-unknown
icon: <override-icon> # optional icon for the message (supports both emoji and url notation)
----
<1> Default name of the `NotificationsConfiguration` CR in a cluster.
<2> An example custom subscription configuration for the `NotificationsConfiguration` CR.

You can configure the `NotificationsConfiguration` CR by using the {OCP} web console or the CLI (`oc`).